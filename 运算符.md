---
theme: apple-basic
background: https://cover.sli.dev
layout: intro
class: text-center
highlighter: shiki
transition: view-transition
mdc: true
--- 

# 桥梁: VBA中的运算符

Power by Will Ran

<div class="pt-12">
  <span @click="next" class="px-2 p-1 rounded cursor-pointer hover:bg-white hover:bg-opacity-10">
    Learn more <carbon:arrow-right class="inline"/>
  </span>
</div>


---
transition: view-transition
---

# 算术运算符

<div v-click=1>

算术运算符用于算术运算，返回值的类型为数值型


| 运算符 | 作用              | 示例          |
|-----|-----------------|-------------|
| +   | 求两个数的和          | 5+9=14      |
| -   | 求两个数的差：求一个数的相反数 | 8-5=3；-3=-3 |
| *   | 求两个数的积          | 6*5=30      |
| /   | 求两个数的商          | 5/2=2.5     |
| \   | 整除(两数相除取商的整数)   | 5\2=2       |
| ^   | 指数运算(求一个数的次方)   | 5^3=555=125 |
| Mod | 求模运算(两数相除取余数)   | 12 Mod 9=3  |


</div>

---
transition: view-transition
---


# 比较运算符

<div v-click=1>

比较运算符用于比较运算，如比较两个数的大小。返回值为Boolean型，只能为True或False。

| 运算符  | 作用          | 语法               | 返回结果                                   |
|------|-------------|------------------|----------------------------------------|
| =    | 等于          | 表达式 1 = 表达式 2    | 当两个表达式相同时返回 True，否则返回 False            |
| <    | 小于          | 表达式 1 < 表达式 2    | 当表达式 1 小于表达式 2 时返回 True，否则返回 False     |
| >    | 大于          | 表达式 1 > 表达式 2    | 当表达式 1 大于表达式 2 时返回 True，否则返回 False     |
| <=   | 小于或等于       | 表达式 1 <= 表达式 2   | 当表达式 1 小于或等于表达式 2 时返回 True，否则返回 False  |

</div>

---

| 运算符  | 作用          | 语法               | 返回结果                                   |
|------|-------------|------------------|----------------------------------------|
| >=   | 大于或等于       | 表达式 1 >= 表达式 2   | 当表达式 1 大于或等于表达式 2 时返回 True，否则返回 False  |
| <>   | 不等于         | 表达式 1 <> 表达式 2   | 当表达式 1 不等于表达式 2 时返回 True，否则返回 False    |
| Is   | 比较两个对象的引用变量 | 对象 1 Is 对象 2     | 当对象 1 和对象 2 引用相同的对象时返回 True，否则返回 False |
| Like | 比较两个字符串是否匹配 | 字符串 1 Like 字符串 2 | 当字符串 1 与字符串 2 匹配时返回 True，否则返回 False    | 

---





```vb {none|1,13|2-6|8-12|all} twoslash
Sub Bjys()
  If Range("B2").Value Like "李*" Then
    MsgBox "姓李。"
  Else
    MsgBox "不姓李。"
  End If

  If Range("B2").Value Like "＊克＊" Then
    MsgBox "含有克字。"
  Else
    MsgBox "不含有克字。"
  End If
End Sub
```
---


| 通配符        | 作用                     | 示例                        |
|------------|------------------------|---------------------------|
| *          | 替代任意多个字符               | "李家军" Like "家" = True     |
| ?          | 替代任意的一个字符              | "李家军" Like "李 ??" = True  |
| #          | 替代任意的一个数字              | "商品5" Like "商品#" = True   |
| [charlist] | 替代位于 charlist 中的任意一个字符 | "I" Like "[A-Z] = True    |
| [!charlist]         | 替代不在 charlist 中的任意一个字符 | "I" Like "[!H-J] = False |


---
layout: two-cols
---

<div v-click=1>

| 说明                             |
| -------------------------------- |
| 判断 J2 的分数是否达到 500       |
| 判断 D3 的分数是否大于 90        |
| 判断 C4 的分数是否大于 D4 的分数 |
| 判断 B5 的学生是否姓王          |
| 判断 B6 的学生姓名是以"银”字结尾 |
</div>



::right::

<div v-click=2>

| 表达式                              |
| ----------------------------------- |
| Range("J2").Value>=500              |
| Range("D3").Value>90                |
| Range("C4").Value>Range("D4").Value |
| Range("B5").Value Like "王*"       |
| Range("B5").Value Like "*银"       |

</div>




---
layout: two-cols
transition: view-transition
---


# 连接运算符

<div v-click=1>

**连接运算符用来连接两个文本字符串，<span v-mark.circle.red="2">有+和&两种 </span>**

- +可以用作算术运算的加运算，也可以用于文本连接运算。
- 如果+运算符两边的表达式都是文本字符串，则执行连接运算；
- 如果+运算符两边的表达式包含数值，则执行算术运算

</div>

::right::

<div v-click=3>

```vb {none|none|none|1,16|2-5|7-10|12-15|all} twoslash
Sub Test()
  a = 1
  b = 2
  c1 = a + b
  c2 = a & b

  a = "一"
  b = "二"
  c1 = a + b
  c2 = a & b

  a = 1
  b = "二"
  c1 = a + b
  c2 = a & b
End Sub
```
</div>


---
transition: view-transition
---

# 逻辑运算符

| 运算符 | 作用 | 语法 | 返回结果 |
|--------|------|------|----------|
| And | 执行逻辑“与”运算 | 表达式1 And 表达式2 | 表达式1和表达式2的值都为True时返回True，否则返回False |
| Or | 执行逻辑“或”运算 | 表达式1 Or 表达式2 | 表达式1和表达式2中只要有一个表达式的值为True时返回True，否则返回False |
| Not | 执行逻辑“非”运算 | Not 表达式 | 表达式的值为True时返回False，否则返回True |

---
transition: view-transition
---

# Quiz

<div v-click=1>

如果想判断第一条记录中语文、数学两个学科中是否有及格（大于或等于60分）的科目

</div>

<div v-click=2>

```vb
Range("C2") >= 60 Or Range("D2") >= 60
= Ture Or False
= True
```
</div>


---
transition: view-transition
---

# 应该先进行什么运算

<br>

在VBA中，要先处理算术运算符，接着处理连接运算符，然后处理比较运算符，最后再处理逻辑运算符。可以用括号来改变运算顺序。

<br>

运算符按运算的优先级由高到低的次序排列为：

```mermaid

flowchart LR
    括号 --> 指数运算 --> 求相反数 --> 乘法和除法 --> 整除 --> 求模运算 --> 加法和减法 --> 字符串连接 --> 比较运算 --> 逻辑运算
    
```

$$

\left( (a + b)^2 - (-y) \right) \times \left( \frac{z}{w} \right) + \left( m \div n \right) + \left( r \mod s \right) - (c - d) + (str1 + str2)  

$$

---

# LaTeX

LaTeX is supported out-of-box. Powered by [KaTeX](https://katex.org/).

<div h-3 />

Inline $\sqrt{3x-1}+(1+x)^2$

Block
$$ {1|3|all}
\begin{aligned}
\nabla \cdot \vec{E} &= \frac{\rho}{\varepsilon_0} \\
\nabla \cdot \vec{B} &= 0 \\
\nabla \times \vec{E} &= -\frac{\partial\vec{B}}{\partial t} \\
\nabla \times \vec{B} &= \mu_0\vec{J} + \mu_0\varepsilon_0\frac{\partial\vec{E}}{\partial t}
\end{aligned}
$$

[Learn more](https://sli.dev/guide/syntax#latex)

---


---
transition: view-transition
---

# Quiz

用脱等式计算出下面表达式的结果。2580 ＞ （1000 + 4000） Or 150 ＜ 236“学号：​” & 1006110258 Like “＊258” And （125 + 120 + 140） ＞ 400

---
layout: center
class: "text-center"
---

# **Thank You**